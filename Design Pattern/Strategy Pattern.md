// 2022.09.27 NoelπΈ



# β¤οΈβ€π”¥ μ¤νΈλ ν‹°μ§€ ν¨ν„΄(Strategy Pattern)<br/>

<br/>

### π¤” μ „λµ ν¨ν„΄(Strategy Pattern)μ΄λ€?<br/>

> μ „λµ ν¨ν„΄μ€ **μ•κ³ λ¦¬μ¦μ μ§‘ν•©(Algorithm Family)**μ„ μ‚¬μ©ν•λ” **ν–‰μ„ ν¨ν„΄<br/>**

- μ—¬λ¬ μ•κ³ λ¦¬μ¦μ„ κ°κ° κ°μ²΄λ΅ **μΊ΅μν™”**ν•κ³ , λ™μΌν• λ©μ μ„ ν•λ” μ•κ³ λ¦¬μ¦μ„ ν•λ‚μ μΈν„°νμ΄μ¤λ΅ λ¬¶μ<br/>

- κ·ΈλΌ μ΄ μ•κ³ λ¦¬μ¦λ“¤μ΄ ν΄λΌμ΄μ–ΈνΈ κ°μ²΄μ—μ„ κµμ²΄λλ©΄μ„ μ‚¬μ© ν•  μ μμ<br/>

- λ”°λΌμ„ μ•κ³ λ¦¬μ¦μ΄ ν΄λΌμ΄μ–ΈνΈ κ°μ²΄μ— λ…λ¦½μ μΌλ΅ κµ¬μ„±λκΈ° λ•λ¬Έμ— **λμ¨ν• μ—°κ²°(Decoupling)**μ΄ λ¨<br/>

  - λμ¨ν•κ² μ—°κ²°λλ©΄ ν΄λΌμ΄μ–ΈνΈ κ°μ²΄κ°€ μ•κ³ λ¦¬μ¦μ΄ λ³€ν• λ• μν–¥μ„ λ°›μ§€ μ•λ” κ²ƒμ„ μλ―Έ!<br/>

  ```
  μ) μ•κ³ λ¦¬μ¦ μμ •μ΄ ν•„μ”ν• μƒν™©μ—μ„
  - μΊ΅μν™”λ ν•΄λ‹Ή μ•κ³ λ¦¬μ¦λ§ μμ •ν•λ©΄ λκ³  λ‚΄λ¶€μ μΌλ΅ μ–΄λ–»κ² μμ •λκ³  μ–΄λ–»κ² κµ¬ν„λμ—λ”μ§€ ν΄λΌμ΄μ–ΈνΈ κ°μ²΄λ” μ•μ§€λ»ν•¨
  ```

<br/>

<br/>

### μ „λµ ν¨ν„΄ κµ¬μ΅°<br/>

![image-20220927170937679](/Users/yuahyeon/Library/Application Support/typora-user-images/image-20220927170937679.png)

π”µ **Context (Composition)** <br/>

- `Concrete Strategy` κ°μ²΄λ΅ κµ¬μ„±<br/>
- `Strategy` κ°μ²΄μ— λ€ν• μ°Έμ΅°λ¥Ό μ μ§€<br/>
- `Strategy`κ°€ λ°μ΄ν„°μ— μ ‘κ·Ό ν•  μ μλ” μΈν„°νμ΄μ¤λ¥Ό μ •μ<br/>

<br/>

π”΄ **Strategy (Compositor)** <br/>

- μ§€μ›λλ” λ¨λ“  μ•κ³ λ¦¬μ¦μ— μ‚¬μ©λλ” κ³µν†µμ μΈ μΈν„°νμ΄μ¤λ¥Ό μ •μ<br/>
- `Context`λ” `Strategy` μΈν„°νμ΄μ¤λ¥Ό μ‚¬μ©ν•μ—¬ `Concrete Strategy`μ— μ •μλ μ•κ³ λ¦¬μ¦μ„ νΈμ¶<br/>

<br/>

**π”΄ Concrete Strategy** <br/>

- `Strategy` μΈν„°νμ΄μ¤λ¥Ό μ‚¬μ©ν•μ—¬ μ•κ³ λ¦¬μ¦μ„ κµ¬ν„<br/>

<br/>

<br/>

### μ „λµ ν¨ν„΄μ€ μ–Έμ  μ‚¬μ©ν• κΉ?<br/>

μ „λµν¨ν„΄μ€ **μ–΄λ–¤ μƒν™©μ—μ„ μ‚¬μ©ν•  μ•κ³ λ¦¬μ¦μ΄ μ—¬λ¬ κ° μ΅΄μ¬ν•  λ•** μ‚¬μ©ν•λ©΄ μΆ‹μ

- μ•κ³ λ¦¬μ¦μ„ λ°νƒ€μ„μ—μ„ λ°”κΏ€ μ μκΈ° λ•λ¬Έμ— μ΄λ° μƒν™©μ—μ„ ν¨κ³Όμ μΌλ΅ λ€μ‘ν•  μ μμ

```μμ‹
μμ‹ μƒν™©

μλ™μ°¨μ κ²½λ΅λ§ μ•λ ¤μ£Όλ” λ‚΄λΉ„κ²μ΄μ… μ μ‘ν•¨ 
> κ·Έλ¬λ‹¤ μ‚¬μ©μκ°€ λμ–΄ [λ„λ³΄λ΅ μ΄λ™ν•λ” μ‚¬λμ κ²½λ΅], [λ€μ¤‘κµν†µμ„ μ΄λ™ν•λ” μ‚¬λμ κ²½λ΅]μ™€ κ°™μ΄ λ‹¤μ–‘ν• μ•κ³ λ¦¬μ¦μ΄ ν•„μ”ν•΄μ§ 
> μ΄λ•β—οΈ ν΄λμ¤ μ•μ— κ³„μ†ν•΄μ„ κµ¬ν„ν•λ‹¤ λ³΄λ©΄, ν•λ‚μ λ³€κ²½μΌλ΅ μΈν•΄ λ§μ€ κ³³μ„ μμ •ν•΄μ•Ό ν•λ” λ¬Έμ κ°€ λ°μƒν•©

μ΄λ¥Ό ν•΄κ²°ν•κΈ° μ„ν•΄ μ „λµ ν¨ν„΄μ„ μ‚¬μ©
> [μλ™μ°¨μ κ²½λ΅], [λ„λ³΄λ΅ μ΄λ™ν•λ” κ²½λ΅], [λ€μ¤‘κµν†µ κ²½λ΅]μ— λ€ν• μ•κ³ λ¦¬μ¦μ„ λ”°λ΅ κµ¬ν„ν•κ³  μ΄λ“¤μ„ μΊ΅μν™”
> κ°κ°μ μ•κ³ λ¦¬μ¦μ„ μ„λ΅μ—κ² μν–¥μ„ μ£Όμ§€λ„ μ•κ³  κ°μ λ…λ¦½μ μΌλ΅ μ‘λ™ν•λ„λ΅ λ§λ“¤μ–΄μ¤μΌλ΅μ¨ μ„μ λ¬Έμ  ν•΄κ²°κ°€λ¥!

μ¶μ²: https://icksw.tistory.com/259 [PinguiOS:ν‹°μ¤ν† λ¦¬]
```

<br/>

<br/>

### μ¥λ‹¨μ <br/>

π‘**μ¥μ **<br/>

- λ°νƒ€μ„μ—μ„ κ°μ²΄ λ‚΄λ¶€μ—μ„ μ‚¬μ©λλ” μ•κ³ λ¦¬μ¦μ„ λ³€κ²½ν•  μ μμ<br/>
- `μ•κ³ λ¦¬μ¦μ„ μ‚¬μ©ν•λ” μ½”λ“`μ™€ `μ•κ³ λ¦¬μ¦μ„ κµ¬ν„ν•λ” μ½”λ“`λ¥Ό λ¶„λ¦¬ ν•  μ μμ<br/>
- `Open / Closed Principle`(κ°λ°© νμ‡„ μ›μΉ™)μ„ μ¤€μ <br/>
  - `Context`λ¥Ό λ³€κ²½ν•μ§€ μ•κ³ λ„ μƒλ΅μ΄ `Strategy`λ¥Ό μ¶”κ°€ν•  μ μμ<br/>

<br/>

π‘**λ‹¨μ **<br/>

- μ•κ³ λ¦¬μ¦μ΄ λ‡ κ° μ—†κ³  λ³€κ²½λλ” μΌλ„ κ±°μ μ—†λ” κ²½μ°, μ „λµ ν¨ν„΄μ λ„μ…μ΄ μ¤νλ ¤ λ³µμ΅μ„±μ„ μ¦κ°€<br/>
- ν΄λΌμ΄μ–ΈνΈκ°€ μ μ ν• `Strategy`λ¥Ό μ„ νƒν•κΈ° μ„ν•΄μ„λ” κ°κ°μ μ°¨μ΄μ μ„ μ•κ³  μμ–΄μ•Ό ν•©λ‹λ‹¤.<br/>
- `Strategy`, `Context` κ°„ ν†µμ‹  μ¤λ²„ν—¤λ“κ°€ λ°μƒ<br/>

<br/>

## π• Swift μμ !<br/>

κ·ΈλΌ Swiftλ΅ ν•λ² λ§λ“¤μ–΄ λ³ΌκΉμ”?<br/>

μμ λ” κ°λ°ν•λ” ν›μ΄λ‹ λΈ”λ΅κ·Έ κΈ°λ°μΌλ΅ μ‘μ„±λμ—μµλ‹λ‹¤! <br/>(μ›λ¬Έ : https://jeonyeohun.tistory.com/379)<br/>



![image-20220927212238480](/Users/yuahyeon/Library/Application Support/typora-user-images/image-20220927212238480.png)

μ–΄λ–¤ λ¬Έμμ—΄μ΄ λ“¤μ–΄μ™”μ„λ• μ΅°κ±΄μ„ κ²€μ‚¬ν•΄μ£Όλ” `Validator` κ°μ²΄κ°€ μμ<br/>

μ§€κΈμ€ λ³„ λ¬Έμ  μ—†μ§€λ§ λ‚μ¤‘μ— μ¶”κ°€μ  μ”κµ¬μ‚¬ν•­μ΄ μƒκ²¨ μ” κ°μ²΄μ— μ•κ³ λ¦¬μ¦μ„ μ¶”κ°€ν•κ² λλ©΄<br/>

κΈ°μ΅΄ κ°μ²΄μ— λ³€κ²½μ‚¬ν•­μ΄ μƒκΈ°κΈ° λ•λ¬Έμ— `κ°λ°©νμ‡„μ›μΉ™(OCP)`μ— μ–΄κΈ‹λ‚¨!<br/>

<br/>

### β€ΌοΈ λ”°λΌμ„ μ „λµν¨ν„΄μ„ μ‚¬μ©ν•΄μ•Όν•¨!<br/>

![image-20220927213124669](/Users/yuahyeon/Library/Application Support/typora-user-images/image-20220927213124669.png) μ „λµν¨ν„΄μ€ ν΄λΌμ΄μ–ΈνΈ κ°μ²΄λ” `Strategy(μ•κ³ λ¦¬μ¦ μ§‘ν•©μ μΈν„°νμ΄μ¤)`λ¥Ό κ°€μ§€κ³   ν•„μ”μ— λ”°λΌ μ£Όμ…ν•  μ μμ<br/>

λ μƒλ΅μ΄ μ”κµ¬μ‚¬ν•­μΈ μ•„μ¤ν‚¤ μ½”λ“λ¥Ό κ²€μ‚¬ν•λ” μ•κ³ λ¦¬μ¦μ„  `Strategy`μ— μ¶”κ°€ν•¨μ— λ”°λΌ  `κ°λ°©νμ‡„μ›μΉ™(OCP)`μ„ μ§€ν‚¬ μ μμ<br/>

<br/>

#### κ·ΈλΌ μ΄μ  Swift μ½”λ“λ΅ κµ¬ν„ν•΄λ³΄μ!<br/>

μ„μ μμ‹ μƒν™©μ„ ν† λ€λ΅ μ½”λ“λ΅ μ‘μ„±<br/>

<br/>

#### β‘  `Context` `Strategy`κ°€ λ  ν”„λ΅ν† μ½ μ •μ<br/>

```swift
//Strategy = μ•κ³ λ¦¬μ¦μ μΈν„°νμ΄μ¤κ°€ λ  ν”„λ΅ν† μ½
protocol Validatable {
    func validate(text: String) -> Bool
  // validate() : μΈμλ΅ λ¬Έμμ—΄μ„ λ°›μΌλ©΄ μ μ ν• μ•κ³ λ¦¬μ¦ μν–‰λ’¤μ— Boolνƒ€μ… λ°ν™
  // μ „λµμ— λ§λ” μ•κ³ λ¦¬μ¦λ“¤μ€ μ΄ ν”„λ΅ν† μ½μ„ μ±„νƒν•΄ validateλ¥Ό κµ¬ν„ν•λ©΄ λ¨
}
 
//Context = ν΄λΌμ΄μ–ΈνΈ κ°μ²΄ λ‚΄λ¶€μ μΈν„°νμ΄μ¤λ¥Ό μ κ³µν•  ν”„λ΅ν† μ½
protocol Validator {
    var validationStrategy: Validatable { get set }
  //κ²€μ¦μ— μ‚¬μ©ν•  μ•κ³ λ¦¬μ¦μ μΈν„°νμ΄μ¤λ¥Ό κ°€μ§€κ²λ¨
    func validate(text: String) -> Bool
  // μ‹¤μ λ΅ μ‚¬μ©μκ°€ νΈμ¶ν•κ³  κ²°κ³Όλ¥Ό λ°ν™ν•κ²λ  λ©”μ†λ“
}
```

 <br/>

#### β‘΅ Context (ν΄λΌμ΄μ–ΈνΈ κ°μ²΄) μ •μ

- `StringValidator`μ `validate` λ©”μ„λ“
  - μ•κ³ λ¦¬μ¦ μ—†μ
  - λ€μ‹  `Strategy(validationStrategy)`μ΄ κ°€μ§„ μ•κ³ λ¦¬μ¦μ„ μ‹¤ν–‰ν•΄ κ·Έ κ²°κ³Όλ¥Ό λ°ν™
  - μ¦‰! μ΄κ²ƒμ΄ **μ•κ³ λ¦¬μ¦μ κµ¬ν„κ³Ό μ•κ³ λ¦¬μ¦μ„ μ‚¬μ©ν•λ” κ°μ²΄κ°€ μ™„μ „ν λ¶„λ¦¬**λ κ²ƒ!!

```swift
// Context (ν΄λΌμ΄μ–ΈνΈ κ°μ²΄) μ •μ
final class StringValidator: Validator {
    var validationStrategy: Validatable
    
    init(strategy: Validatable) {
        self.validationStrategy = strategy
    }
    
    func change(strategy: Validatable) {
        self.validationStrategy = strategy
    }
    // change λ©”μ„λ“λ¥Ό ν†µν•΄ ν„μ¬ μ•κ³ λ¦¬μ¦μ„ λ‹¤λ¥Έ μ•κ³ λ¦¬μ¦μΌλ΅ λ³€κ²½ κ°€λ¥
  
    func validate(text: String) -> Bool {
        return validationStrategy.validate(text: text)
    }
  //κ²€μ¦ μ•κ³ λ¦¬μ¦μ„ μν–‰
}
```

<br/>

#### β‘Ά Concrete Strategy (μ•κ³ λ¦¬μ¦) κµ¬ν„!<br/>

- `Strategy`μ„ μ±„νƒν•λ” λ‘κ°μ μ•κ³ λ¦¬μ¦ μ μ‘!<br/>

```swift
// λ¬Έμμ—΄μ΄ μ«μμΈμ§€ ν™•μΈν•λ” μ•κ³ λ¦¬μ¦
class NumberValidator: Validatable {
    func validate(text: String) -> Bool {
        return text.allSatisfy({ $0.isNumber })
    }
}
 
// λ¬Έμμ—΄μ κΈΈμ΄κ°€ 10 λ―Έλ§μΈμ§€ ν™•μΈν•λ” μ•κ³ λ¦¬μ¦
class LengthValidator: Validatable {
    func validate(text: String) -> Bool {
        return text.count < 10
    }
}
```

<br/>

#### β‘£ Context (ν΄λΌμ΄μ–ΈνΈ κ°μ²΄) μ‚¬μ© λ° λ³€κ²½<br/>

- ν΄λΌμ΄μ–ΈνΈ κ°μ²΄ μ‚¬μ© μ‹ : μƒμ„±μλ¥Ό ν†µν•΄ μ‚¬μ©ν•  μ•κ³ λ¦¬μ¦μ„ μ„ νƒ<br/>
- ν΄λΌμΈμ–ΈνΈμ—μ„ μ‚¬μ©ν•  μ•κ³ λ¦¬μ¦ λ³€κ²½ : `change` λ©”μ„λ“λ¥Ό ν†µν•΄<br/>

```swift
// Context μ—μ„ μ‚¬μ©ν•  μ•κ³ λ¦¬μ¦ μ„ νƒ
let validator = StringValidator(strategy: LengthValidator())
print(validator.validate(text: "12345678910")) // false
 
//Context μ—μ„ μ‚¬μ©ν•  μ•κ³ λ¦¬μ¦ λ³€κ²½
validator.change(strategy: NumberValidator())
print(validator.validate(text: "12345678910")) // true
```

<br/>

#### β„ μƒλ΅μ΄ Concrete Strategy (μ•κ³ λ¦¬μ¦) μ¶”κ°€<br/>

```swift
// μƒλ΅μ΄ μ•κ³ λ¦¬μ¦ μ¶”κ°€ : λ¬Έμμ—΄μ΄ μ•„μ¤ν‚¤ μ½”λ“λ΅ ν‘ν„κ°€λ¥ν•μ§€ ν™•μΈν•λ” μ•κ³ λ¦¬μ¦
class AsciiValidator: Validatable {
    func validate(text: String) -> Bool {
        return text.allSatisfy({ $0.isASCII })
    }
}
```

```swift
// ν΄λΌμ΄μ–ΈνΈ κ°μ²΄μ— μ μ©
validator.change(strategy: AsciiValidator())
print(validator.validate(text: "12345678910")) // true
```

<br/>

<br/>

<HR/>

μ¶μ²<br/>

 https://icksw.tistory.com/259 <br/>

https://jeonyeohun.tistory.com/379<br/>











