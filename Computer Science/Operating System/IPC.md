// 20220907

// Brown

# 🟠 IPC (Inter Process Communication)

<p align="center"><img width="422" alt="image" src="https://user-images.githubusercontent.com/96969693/188942536-a0fa93c9-2ebd-4c7f-87ae-5be4c24e93d7.png"></p>

- 위 사진처럼 프로세스는 각자 독립된 메모리 공간을 가지고 있어서 서로간의 데이터를 공유할 방법이 없다.
- 그렇기 때문에 나온 방식이 IPC로 프로세스 간 통신을 하는 방법이다.
- 프로세스간 통신이란, 프로세스 간의 데이터 송수신이 있다는 뜻이고, 메모리를 공유해야 한다는 뜻이다. 이러기 위해서는 '통신을 위한 도구'가 필요하다. == IPC

```
즉 IPC 란, 프로세스 간의 통신을 가능하게 해주는 통신 방법이다
```

프로세스는 Kernel(커널)이 제공하는 IPC설비를 이용하여 프로세스간에 통신을 할 수 있게 된다.

### 📝 커널이란?

운영체제 중 항상 필요한 부분만을 전원이 켜짐과 동시에 메모리에 올려놓고, 그렇지 않은 부분은 필요할 때 메모리에 올려서 사용하게 되는데, 이때 메모리에 상주하는 운영체제들을 Kernel 이라고 한다. 보통 Kernel 이라고 칭하면, 가장 중요한 '운영체제들'이라고 생각하면 편하다.

# 🟠 IPC 종류

IPC종류에도 여러가지가 있다. 필요에 따라 IPC 통신 방식을 선택해서 잘 사용해야 한다. IPC는 아래와 같이 분류할 수 있다

<p align="center"><img width="453" alt="image" src="https://user-images.githubusercontent.com/96969693/188942675-424c0d3b-c44e-4250-bcc3-7da697e3dd02.png"></p>

```
메시지 전달 시스템
공유 메모리 시스템
```

## 🔸 메시지 전달 시스템 
- 커널을 경유하여 고정 길이 메시지, 가변길이 메시지를 송/수신자 끼리 주고받으며, 커널에서는 데이터를 버퍼링한다.
- 프로세스간 메모리 공유 없이 동작이 가능하다..
- 서버-클라이언트 방식의 통신이 메시지 전달 시스템의 가장 대표적인 예시라고 보면 된다.
- 메시지 전달 모델에서 iPC는 해당 프로세스 입장에서 일종의 I/O로 볼 수 있다. 그래서 IPC를 하면 할 수록 컨텍스트 스위칭이 많이 일어난다.

### 👉 메시지 전달 모델의 구현 IPC 종류

```
PIPE
Message Queue
Socket 등
```

### 🥕 PIPE (익명 PIPE)

<p align="center"><img width="336" alt="image" src="https://user-images.githubusercontent.com/96969693/188942879-b0f52766-383f-4159-b881-f1d0aefdb9a3.png"></p>

- 공유 매개체는 '파일'이다.
- 부모 프로세스와 자식 프로세스 간 통신을 할 때 사용한다.
- 해당 방식의 목적은 fork() 를 사용하여 부모, 자식 프로세스를 만들어 각 프로세스를 각 코어에 동시 실행이 가능하게 하여 빠른 실행을 하기 위함. 즉 병렬 처리를 하여 빠른 프로그램 실행이 목적이다.
- 익명 PIPE는 하나의 프로세스는 데이터를 쓰기만, 다른 하나는 읽기만 가능하다.
- 한쪽 방향으로만 통신이 가능하기 때문에 Half-Duplex(반이중) 통신 이라고 부른다. (이는 PIPE두개를 사용해서 양방향으로 만들 수 있지만, 구현이 매우 복잡해질 수 있다.)
- 통신을 할 프로세스가 뭔지 명확하게 알 수 있는 경우 사용한다.
- 구현이 매우 간단하다는 장점이 있다.

### 🥕 Named PIPE 

- 공유 매개체는 '파일' 이다.
- FIFO 방식을 사용한다.
- 익명 PIPE와는 다르게 부모 프로세스와 무관하게 전혀 다른 프로세스들 사이에서 통신이 가능하다.
- 통신을 위해서 이름이 있는 파일들을 사용한다.
- 익명 PIPE와 같이 단방향 통신만 가능하지만, 이름이 있는 파일 두개를 사용해서 이를 해결할 수는 있다.
 
### 🥕 Message Queue  (메시지 큐)

- 양방향 통신방식이다.
- 공유 매개체는 '메모리'이다.
- Named PIPE와 같은 입출력 방식을 사용 (FIFO) 하지만, Named PIPE는 데이터의 흐름이라면, 메시지큐는 '메모리 공간'이라는 차이가 존재한다.
- 데이터를 주고받기 위한 '메시지 큐'를 커널에서 관리하는 방식이다.
- 모든 프로세스에서 접근이 가능하다. (메시지큐의 접근자(식별자)를 아는 모든 프로세서는 동일한 메시지큐에 접근해서 데이터를 공유할 수 있다.)
 
### 🥕 Socket (소켓)
- 네트워크 소켓 통신을 통해 데이터를 공유한다.
- 클라이언트와 서버가 소켓을 통해서 통신하는 구조로, 원격에서 프로세스간 데이터를 공유할 때 사용한다.
 

## 🔸 공유 메모리 시스템 

- 양방향 통신이다.
- 공유 매개체는 메모리이다.
- 두 개 이상의 프로세스들이 주소공간의 일부를 공유하며, 공유한 메모리 영역에 읽기/쓰기를 통해 통신한다.
- 공유 메모리가 설정되면, 그 이후 통신은 커널의 관여 없이 진행 가능하다.
- 중개자 없이 곧바로 메모리에 접근할 수 있기 때문에 모든 IPC 중에서 가장 빠르게 작동한다. (커널에 관여가 없이 메모리에 직접 접근하기 때문에!)
- 프로그램 레벨에서 통신기능을 제공하여 자유로운 통신이 가능하다.
- 프로세스가 공유 메모리 할당을 커널에 요청하면, 커널은 해당 프로세스에 대한 메모리 공간을 할당해주고, 이후 모든 프로세스는 해당 메모리 영역에 접근할 수 있게 된다. (공유 메모리의 ID를 알면 누구나 해당 메모리에 접근 가능)
 
 
### 🥕 File - Memory mapping (메모리 맵)
- 메모리 맵은 열린 파일을 메모리에 매핑시켜서 공유하는 방식이다 (즉, 공유 매개체가 파일 + 메모리이다.)
- 주로 파일로 대용량 데이터를 공유해야할 때 사용한다.
 

# ✅ 면접때 나올 만한 질문들

- 프로세스간 통신이 필요한 이유는?
  - 특정 테스크를 빨리 실행하고자 한다면 병렬처리가 필요합니다. 그렇다면 서로 데이터의 공유가 필요합니다. 
  - 프로세스는 각자 독립된 메모리 공간을 가지고 있는데, 서로의 데이터를 공유하는 도구가 필요할 것입니다.

# 📖 References
- [운영체제 IPC](https://dong-wook94.github.io/cs/2020/11/10/cs-os-ipc/)
- [Github gyoogle](https://github.com/gyoogle/tech-interview-for-developer/blob/master/Computer%20Science/Operating%20System/IPC(Inter%20Process%20Communication).md)
- [IPC](https://velog.io/@qweadzs/CS-IPCInter-Process-Communication)
- [github 신입개발자 - ipc](https://github.com/workhardslave/cs-study/blob/main/OS/IPC%26RPC.md)
- [ipc종류와 특징](https://parkgaebung.tistory.com/64)




